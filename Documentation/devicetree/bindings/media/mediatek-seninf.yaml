# SPDX-License-Identifier: (GPL-2.0-Only OR BSD-2-Clause)
%YAML 1.2
---
$id: http://devicetree.org/schemas/media/mediatek-seninf.yaml#
$schema: http://devicetree.org/meta-schemas/core.yaml#

title: Mediatek Sensor Interface (CSI) Device Tree Bindings

maintainers:
  - Louis Kuo <louis.kuo@mediatek.com>

description: |
  The SENINF is the CSI-2 and parallel camera sensor interface found in
  multiple MediaTek SoCs.

properties:
  compatible:
    const: mediatek,mt8183-seninf

  reg:
    minItems: 1

  interrupts:
    maxItems: 1

  power-domains:
    maxItems: 1

  clocks:
    items:
      - description: Seninf camsys clock
      - description: Seninf top mux clock

  clock-names:
    items:
      - const: cam_seninf
      - const: top_mux_seninf

  phys:
    items:
      - description: CSI0 C/D-PHY (3 trios, 4 data lanes + 1 clock lane)
      - description: CSI1 D-PHY (4 data lanes + 1 clock lane)
      - description: CSI2 D-PHY (4 data lanes + 1 clock lane)
      - description: CSI0A D-PHY (2 data lanes + 1 clock lane)
      - description: CSI0B D-PHY (2 data lanes + 1 clock lane)

  phy-names:
    items:
      - const: csi0
      - const: csi1
      - const: csi2
      - const: csi0a
      - const: csi0b

  # See ./video-interfaces.txt for details
  ports:
    type: object
    additionalProperties: false
    description: |
      The SENINF has three physical CSI-2 input ports, CSI0, CSI1 and CSI2,
      that support up to four data lanes in D-PHY mode. Additionally, the CSI0
      port can support C-PHY mode with up to three trios, and can be split in
      two independent ports CSI0A and CSI0B (in D-PHY mode with two data lanes)
      to connect two separate sensors.

    properties:
      port@0:
        type: object
        description: CSI0 or CSI0A port
        additionalProperties: false

        properties:
          reg:
            const: 0

        patternProperties:
          endpoint:
            type: object
            additionalProperties: false

            properties:
              data-lanes:
                minItems: 1
                maxItems: 4

              remote-endpoint: true

      port@1:
        type: object
        description: CSI1 port
        additionalProperties: false

        properties:
          reg:
            const: 1

        patternProperties:
          endpoint:
            type: object
            additionalProperties: false

            properties:
              data-lanes:
                minItems: 1
                maxItems: 4

              remote-endpoint: true

      port@2:
        type: object
        description: CSI2 port
        additionalProperties: false

        properties:
          reg:
            const: 2

        patternProperties:
          endpoint:
            type: object
            additionalProperties: false

            properties:
              data-lanes:
                minItems: 1
                maxItems: 4

              remote-endpoint: true

      port@3:
        type: object
        description: CSI0B port
        additionalProperties: false

        properties:
          reg:
            const: 3

        patternProperties:
          endpoint:
            type: object
            additionalProperties: false

            properties:
              data-lanes:
                minItems: 1
                maxItems: 2

              remote-endpoint: true

      port@4:
        type: object
        description: connection point for camsys
        additionalProperties: false

        properties:
          reg:
            const: 4

        patternProperties:
          endpoint:
            type: object
            additionalProperties: false

            properties:
              remote-endpoint: true

    required:
      - port@0
      - port@1
      - port@2
      - port@3
      - port@4

required:
  - compatible
  - interrupts
  - clocks
  - clock-names
  - power-domains
  - ports

additionalProperties: false

examples:
  - |
    #include <dt-bindings/clock/mt8183-clk.h>
    #include <dt-bindings/interrupt-controller/irq.h>
    #include <dt-bindings/interrupt-controller/arm-gic.h>
    #include <dt-bindings/power/mt8183-power.h>

    seninf: seninf@1a040000 {
        compatible = "mediatek,mt8183-seninf";
        reg = <0x1a040000 0x8000>;
        interrupts = <GIC_SPI 251 IRQ_TYPE_LEVEL_LOW>;
        power-domains = <&scpsys MT8183_POWER_DOMAIN_CAM>;
        clocks = <&camsys CLK_CAM_SENINF>,
                 <&topckgen CLK_TOP_MUX_SENINF>;
        clock-names = "cam_seninf", "top_mux_seninf";

        phys = <&mipi_dphy 0>, <&mipi_dphy 1>, <&mipi_dphy 2>,
               <&mipi_dphy 3>, <&mipi_dphy 4>;
        phy-names = "csi0", "csi1", "csi2", "csi0a", "csi0b";

        ports {
            #address-cells = <1>;
            #size-cells = <0>;

            port@0 {
                reg = <0>;
                mipi_in_bcam: endpoint {
                    data-lanes = <0 1 3 4>;
                    remote-endpoint = <&bcam_out>;
                };
            };

            port@1 {
                reg = <1>;
                mipi_in_fcam: endpoint {
                    data-lanes = <1>;
                    remote-endpoint = <&fcam_out>;
                };
            };

            port@2 {
                reg = <2>;
            };

            port@3 {
                reg = <3>;
            };

            port@4 {
                reg = <4>;
                seninf_camisp_endpoint: endpoint {
                    remote-endpoint = <&camisp_endpoint>;
                };
            };
        };
    };

    mipi_dphy: phy@11c80000 {
        compatible = "mediatek,mt8183-mipi_dphy";
        reg = <0x11c80000 0x6000>;
        #phy-cells = <1>;
    };

    i2c2: i2c@11009000 {
        reg = <0x11009000 0x1000>;
        clock-frequency = <400000>;
        #address-cells = <1>;
        #size-cells = <0>;

        wcam: camera@36 {
            compatible = "ovti,ov5695";
            reg = <0x36>;

            port {
                bcam_out: endpoint {
                    remote-endpoint = <&mipi_in_bcam>;
                    data-lanes = <0 1 3 4>;
                };
            };
        };
    };

    i2c4: i2c@11008000 {
        reg = <0x11008000 0x1000>;
        clock-frequency = <400000>;
        #address-cells = <1>;
        #size-cells = <0>;

        ucam: camera@3c {
            compatible = "ovti,ov2685";
            reg = <0x3c>;

            port {
                fcam_out: endpoint {
                    remote-endpoint = <&mipi_in_fcam>;
                    data-lanes = <1>;
                };
            };
        };
    };
...
